#!/bin/bash
# Installation des outils (Ã  exÃ©cuter une fois)

# 1. Installer Husky pour gÃ©rer les hooks Git
npm install --save-dev husky
npx husky install
npm pkg set scripts.prepare="husky install"

# 2. Installer detect-secrets pour dÃ©tecter les secrets
pip install detect-secrets

# 3. Installer ESLint avec plugins sÃ©curitÃ©
npm install --save-dev \
  eslint \
  eslint-plugin-security \
  eslint-plugin-no-secrets

# 4. CrÃ©er le hook pre-commit
npx husky add .husky/pre-commit "npm run pre-commit-check"

# 5. Ajouter les scripts dans package.json
cat << 'EOF' >> package.json.snippet
{
  "scripts": {
    "pre-commit-check": "npm run check-secrets && npm run lint:security && npm run format:check",
    "check-secrets": "detect-secrets scan --baseline .secrets.baseline --all-files",
    "lint:security": "eslint --ext .js,.ts --plugin security --plugin no-secrets .",
    "format:check": "prettier --check '**/*.{js,ts,json,md}'",
    "format:fix": "prettier --write '**/*.{js,ts,json,md}'"
  }
}
EOF

echo "âœ… Pre-commit hooks installÃ©s !"
echo "ğŸ“ Configurez maintenant .eslintrc.security.js"
